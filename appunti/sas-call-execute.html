<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CALL EXECUTE - Eseguire Codice Dinamicamente | SAS Appunti</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../appunti-style.css">
     <link rel="stylesheet" href="../dark-mode.css">
</head>
<body>

    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Camiga tema">
                üåô
    </button>
    <!-- Menu Hamburger -->
    <div class="hamburger" id="hamburger">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>

    <!-- Menu Laterale -->
    <nav class="sidebar" id="sidebar">
        <div class="close-btn" id="closeBtn">&times;</div>
        <ul class="menu">
            <li><a href="../index.html">üè† Home</a></li>
            <li><a href="../sas-programming.html">üìä SAS Programming</a></li>
            <li><a href="../utility.html">üõ†Ô∏è Utility & Tools</a></li>
            <li><a href="../linux.html">üêß Linux & Shell</a></li>
        </ul>
    </nav>

    <!-- Contenuto -->
    <main class="content note-detail">
        <a href="../sas-programming.html" class="back-link">‚Üê Torna agli appunti SAS</a>

        <div class="note-header">
            <h1>CALL EXECUTE - Eseguire Codice Dinamicamente</h1>
            <div class="note-meta">
                <span>üìÅ Categoria: <strong>Data Step</strong></span>
                <span>üìÖ Aggiornato: <strong>10 Dicembre 2024</strong></span>
                <span>‚è±Ô∏è Lettura: <strong>6 min</strong></span>
            </div>
            <div class="card-tags">
                <span class="tag">call execute</span>
                <span class="tag">dinamico</span>
                <span class="tag">automazione</span>
            </div>
        </div>

        <!-- Descrizione -->
        <div class="note-section">
            <h2>üìã Descrizione</h2>
            <p>
                <strong>CALL EXECUTE</strong> √® una routine SAS che permette di <strong>generare ed eseguire 
                codice SAS dinamicamente</strong> durante l'esecuzione di un Data Step.
            </p>
            
        </div>

        <!-- Codice Completo -->
        <div class="note-section">

            <h3>Setup Librerie:</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">SAS</span>
                    <button class="copy-btn" onclick="copyCode(this)">üìã Copia</button>
                </div>
                <pre><code><span class="sas-comment">/* Source ORACLE library */</span>
<span class="sas-keyword">LIBNAME</span> oralib <span class="sas-keyword">ORACLE</span> <span class="sas-keyword">PATH</span>=<span class="sas-string">"xxx"</span> <span class="sas-keyword">SCHEMA</span>=<span class="sas-string">"yyy"</span> <span class="sas-keyword">USER</span>=<span class="sas-string">"uuu"</span>
    <span class="sas-keyword">PASSWORD</span>=<span class="sas-string">"{SAS002}ABCDEFG12345678RTUR"</span> <span class="sas-keyword">ACCESS</span>=<span class="sas-keyword">READONLY</span>;

<span class="sas-comment">/* Target SAS library */</span>
<span class="sas-keyword">LIBNAME</span> sasdl <span class="sas-string">'/sas/data/appdata'</span>;

<span class="sas-comment">/* Driver table SAS library */</span>
<span class="sas-keyword">LIBNAME</span> parmdl <span class="sas-string">'/sas/data/parmdata'</span>;</code></pre>
            </div>
        </div>

        <!-- Metodo 1 -->
        <div class="note-section">
            <h2>Metodo 1: Usando CATS</h2>
            
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">SAS</span>
                    <button class="copy-btn" onclick="copyCode(this)">üìã Copia</button>
                </div>
                <pre><code><span class="sas-keyword">DATA</span> _null_;
    <span class="sas-keyword">SET</span> parmdl.tablelist;
    <span class="sas-keyword">CALL EXECUTE</span>(<span class="sas-function">CATS</span>(
        <span class="sas-string">'data sasdl.'</span>, tname, <span class="sas-string">';'</span>,
            <span class="sas-string">'set oralib.'</span>, tname, <span class="sas-string">';'</span>,
        <span class="sas-string">'run;'</span>));
<span class="sas-keyword">RUN</span>;</code></pre>
            </div>

        </div>

        <!-- Metodo 2 -->
        <div class="note-section">
            <h2> Metodo 2: Con Macro Variabili e Operatore</h2>
            
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">SAS</span>
                    <button class="copy-btn" onclick="copyCode(this)">üìã Copia</button>
                </div>
                <pre><code><span class="sas-keyword">%LET</span> olib = oralib;
<span class="sas-keyword">%LET</span> slib = sasdl;

<span class="sas-keyword">DATA</span> _null_;
    <span class="sas-keyword">SET</span> parmdl.tablelist;
    <span class="sas-keyword">CALL EXECUTE</span>(
        <span class="sas-string">"data &slib.."</span>!!<span class="sas-function">STRIP</span>(tname)!!<span class="sas-string">';'</span>!!
            <span class="sas-string">"set &olib.."</span>!!<span class="sas-function">STRIP</span>(tname)!!<span class="sas-string">';'</span>!!
        <span class="sas-string">'run;'</span>
    );
<span class="sas-keyword">RUN</span>;</code></pre>
            </div>
        </div>

        <!-- Metodo 3 -->
        <div class="note-section">
            <h2>Metodo 3: Macro Variabili con Virgolette Singole</h2>
            
            <div class="code-block">
                <div class="code-header">
                    <span class="code-language">SAS</span>
                    <button class="copy-btn" onclick="copyCode(this)">üìã Copia</button>
                </div>
                <pre><code><span class="sas-keyword">%LET</span> olib = oralib;
<span class="sas-keyword">%LET</span> slib = sasdl;

<span class="sas-keyword">DATA</span> _null_;
    <span class="sas-keyword">SET</span> parmdl.tablelist;
    <span class="sas-keyword">CALL EXECUTE</span>(<span class="sas-string">'data &slib..'</span>!!<span class="sas-function">STRIP</span>(tname)!!<span class="sas-string">';'</span>!!
                    <span class="sas-string">'set &olib..'</span>!!<span class="sas-function">STRIP</span>(tname)!!<span class="sas-string">';'</span>!!
                    <span class="sas-string">'run;'</span>
                   );
<span class="sas-keyword">RUN</span>;</code></pre>
            </div>
        </div>

    </main>

    <script src="../script.js"></script>
    <script src="../appunti-search.js"></script>
    <script src="../theme-toggle.js"></script>
</body>
</html>
